# 设计指南

本文档提供了使用 PPT Master 系统时的详细设计指南和最佳实践。系统支持多种画布格式，包括演示文稿、社交媒体、营销物料等。

## 目录

- [画布格式](#画布格式)
- [颜色系统](#颜色系统)
- [排版规范](#排版规范)
- [布局原则](#布局原则)
- [图表设计](#图表设计)
- [图标使用](#图标使用)
- [常见模式](#常见模式)

## 画布格式

本系统支持多种画布格式，详细规范请参考 [画布格式规范](./canvas_formats.md)。

### 快速格式选择

- **演示汇报**: PPT 16:9 (1280×720) 或 PPT 4:3 (1024×768)
- **小红书分享**: 小红书帖子 (1242×1660, 3:4)
- **朋友圈海报**: 朋友圈 (1080×1080, 1:1)
- **短视频封面**: Story (1080×1920, 9:16)
- **公众号配图**: 公众号头图 (900×383, 2.35:1)

### 格式特性对照

| 格式类型 | 视觉动线 | 主要布局 | 适合内容 |
|---------|---------|---------|---------|
| 横屏 (16:9, 4:3) | 左→右，Z字型 | 多栏、网格 | 数据图表、对比分析 |
| 竖屏 (3:4, 9:16) | 上→下，纵向 | 单栏、堆叠 | 信息流、步骤说明 |
| 方形 (1:1) | 中心辐射 | 居中、四象限 | 单一主题、品牌展示 |

## 颜色系统

### 主色调选择

#### 咨询风格

```
德勤蓝:      #0076A8  - 专业、可靠
麦肯锡蓝:    #005587  - 权威、深度
BCG深蓝:     #003F6C  - 稳重、信任
普华永道橙:  #D04A02  - 活力、创新
安永黄:      #FFE600  - 乐观、清晰
```

#### 通用灵活风格

```
科技蓝:      #2196F3  - 现代、创新
活力橙:      #FF9800  - 热情、积极
成长绿:      #4CAF50  - 健康、增长
专业紫:      #9C27B0  - 创意、高端
警示红:      #F44336  - 紧急、重要
```

### 辅助色系

#### 数据可视化配色

```css
/* 积极趋势 */
绿色系:
  - 深绿: #2E7D32
  - 中绿: #4CAF50
  - 浅绿: #81C784

/* 警示趋势 */
黄色系:
  - 深黄: #F57C00
  - 中黄: #FFA726
  - 浅黄: #FFD54F

/* 负面趋势 */
红色系:
  - 深红: #C62828
  - 中红: #EF5350
  - 浅红: #E57373
```

#### 中性色系

```css
/* 文本层级 */
主文本:   #212121  (黑色, 87% opacity)
副文本:   #757575  (灰色, 60% opacity)
辅助文本: #9E9E9E  (浅灰, 38% opacity)

/* 背景层级 */
主背景:   #FFFFFF
次背景:   #F5F5F5
卡片背景: #FAFAFA
边框:     #E0E0E0
```

### 对比度要求

遵循 WCAG 2.1 AA 级标准：

- 正文文本：至少 4.5:1
- 大号文本（18pt+）：至少 3:1
- 重要数据：至少 7:1（AAA 级）

## 排版规范

### 字体层级

#### 咨询风格

```
H1 - 封面标题:     48-56px, Bold
H2 - 页面标题:     32-36px, Bold
H3 - 章节标题:     24-28px, SemiBold
正文 - 主要内容:   18-20px, Regular
小字 - 注释说明:   14-16px, Regular
```

#### 通用灵活风格

```
H1 - 封面标题:     52-64px, Bold
H2 - 页面标题:     36-42px, Bold
H3 - 章节标题:     28-32px, SemiBold
正文 - 主要内容:   20-24px, Regular
小字 - 注释说明:   16-18px, Regular
```

### 字体选择

#### 字体分类体系

本系统支持中英文双语字体，按风格分为以下类别：

**中文字体**

| 类别 | 代号 | 可选字体 | 适用场景 |
|------|:----:|---------|----------|
| 无衬线黑体 | A | 微软雅黑、黑体、幼圆、华文细黑 | 现代商务、正文（默认） |
| 衬线宋体 | B | 宋体、新宋体、仿宋、华文宋体 | 政务公文、正式报告 |
| 书法楷体 | C | 楷体、华文楷体、华文行楷 | 文化艺术、人文类 |
| 标题黑体 | D | 黑体、华文中宋、思源黑体 Bold | 大标题、强调 |
| 手写艺术 | E | 华文行楷、华文新魏、隶书 | 创意、个性化 |

**英文字体**

| 类别 | 代号 | 可选字体 | 适用场景 |
|------|:----:|---------|----------|
| 无衬线现代 | F | Arial, Calibri, Segoe UI, Helvetica | 现代商务（默认） |
| 衬线经典 | G | Times New Roman, Georgia, Cambria | 正式文档、学术 |
| 标题展示 | H | Impact, Arial Black, Bebas Neue | 大标题、海报 |
| 手写风格 | I | Comic Sans MS, Segoe Script, Ink Free | 轻松活泼 |
| 等宽代码 | J | Consolas, Cascadia Code, Courier New | 数据、代码 |

#### 推荐 font-family

```css
/* 中文字体 */
"Microsoft YaHei", "微软雅黑", sans-serif       /* A: 微软雅黑 */
"SimHei", "黑体", sans-serif                    /* A/D: 黑体 */
"SimSun", "宋体", serif                         /* B: 宋体 */
"FangSong", "仿宋", serif                       /* B: 仿宋 */
"KaiTi", "楷体", serif                          /* C: 楷体 */
"STXingkai", "华文行楷", cursive                /* C/E: 华文行楷 */

/* 英文字体 */
"Arial", sans-serif                             /* F: Arial */
"Calibri", sans-serif                           /* F: Calibri */
"Times New Roman", serif                        /* G: Times */
"Georgia", serif                                /* G: Georgia */
"Impact", sans-serif                            /* H: Impact */
"Consolas", monospace                           /* J: 等宽 */
```

#### 中英文混排推荐

| 场景 | 中文字体 | 英文字体 |
|------|---------|---------|
| 现代商务 | 微软雅黑 (A) | Calibri / Arial (F) |
| 政务公文 | 宋体 (B) | Times New Roman (G) |
| 文化艺术 | 楷体 (C) | Georgia (G) |
| 科技互联网 | 黑体 (D) | Segoe UI (F) |

#### 字体角色

| 角色 | 用途 | 中文推荐 | 英文推荐 |
|------|------|----------|----------|
| 标题字体 | H1/H2 大标题 | A/C/D/E | F/G/H |
| 正文字体 | 段落、要点 | A/B | F/G |
| 强调字体 | KPI、关键词 | D | H/J |
| 注释字体 | 脚注、说明 | A/B | F/G |

### 行高和间距

```
标题行高: 1.2-1.3
正文行高: 1.5-1.6
段落间距: 1.5-2em
列表间距: 0.5-1em
```

### 文本换行与扁平化

- 生成阶段：采用 `<tspan>` 手动换行，并通过 `x`/`dy` 控制行起点与行距，保证与版式行高规范一致（禁用项详见 `AGENTS.md`）。
- 发布/后处理：推荐使用统一后处理工具 `tools/finalize_svg.py`，已包含文本扁平化功能：
  ```bash
  python3 tools/finalize_svg.py <项目路径>
  ```
- 校验要点：对比 `svg_output` 与 `svg_final`，核对行序、样式（如 `font-size`、`font-weight`、`fill`）与定位（`x`/`y`/`transform`）一致；目标文件中不应残留 `<tspan>`。

## 布局原则

### 16:9 画布规范

```
画布尺寸: 1280×720px
安全区域: 1200×640px (留40px边距)
标题区:    1200×100px
内容区:    1200×500px
页脚区:    1200×40px
```

### 网格系统

#### 单栏布局

```
适用场景: 封面、结束页、单一主题
内容宽度: 800-1000px
水平居中
```

#### 双栏布局

```
适用场景: 对比分析、左图右文
栏宽比例: 1:1 或 3:2
栏间距: 40-60px
```

#### 三栏布局

```
适用场景: 并列要点、流程步骤
栏宽比例: 1:1:1
栏间距: 30-40px
```

#### 四象限布局

```
适用场景: 矩阵分析、分类展示
象限尺寸: 560×250px (含间距)
间距: 20-30px
```

### 卡片设计

#### 尺寸规范（强制规则）

```
单行卡片: 高度 530-600px
双行卡片: 每行 265-295px
三栏卡片: 每栏宽度 360-380px
```

#### 内边距

```
标题区: 20-30px
内容区: 30-40px
图表区: 20-30px
```

#### 圆角半径

```
小卡片: 8-12px
大卡片: 12-16px
图表: 8px
按钮: 6-8px
```

## 图片布局规范

含图片页面的布局需根据图片比例动态计算，确保图片完整展示。

**详细规范请参考**：[图片布局规范](./image_layout_spec.md)

**快速规则**：
- 比例 > 2.0 (超宽) → 上下布局
- 比例 1.2-2.0 → 上下或左右，需计算验证
- 比例 < 1.5 (标准/竖图) → 左右布局

## 图表设计

### 常用图表类型

#### 1. KPI 卡片

```
用途: 展示关键指标
布局: 2×2 或 1×4
元素:
  - 大号数字 (48-56px)
  - 指标名称 (18-20px)
  - 趋势图标/百分比
  - 同比/环比说明
```

#### 2. 柱状图

```
用途: 比较数据
推荐:
  - 柱子数量: 3-8个
  - 柱宽: 40-60px
  - 间距: 柱宽的50-80%
  - 显示数值标签
```

#### 3. 折线图

```
用途: 趋势展示
推荐:
  - 线条粗细: 2-3px
  - 数据点: 圆形, 半径 4-6px
  - 网格线: 1px, 浅灰色
  - 图例位置: 右上角或底部
```

#### 4. 饼图/环形图

```
用途: 占比分析
推荐:
  - 分块数量: 3-6个
  - 起始角度: -90度 (12点方向)
  - 环形宽度: 40-60px
  - 显示百分比标签
```

#### 5. 矩阵图

```
用途: 四象限分析
推荐:
  - 2×2布局
  - 轴线: 2px实线
  - 象限标签清晰
  - 数据点大小统一
```

### 图表配色

#### 单色渐变

```css
适用: 同类数据比较
方案: 同一色相，明度递增
示例: #1976D2 → #42A5F5 → #90CAF9
```

#### 对比色组

```css
适用: 不同类别数据
方案: 色轮对比色
示例:
  蓝色组 #2196F3
  橙色组 #FF9800
  绿色组 #4CAF50
```

#### 顺序色

```css
适用: 等级/强度展示
方案: 冷暖渐变
示例: #4CAF50 → #FFC107 → #F44336
```

## 图标使用

### 项目内置图标库（推荐）

本项目提供 **预置图标库**，位于 `templates/icons/`，包含 40+ 常用图标，风格统一，可直接复制使用。

```
查看图标: 浏览器打开 templates/icons/preview.html
使用方式: 详见 templates/icons/README.md
```

**分类概览**：
- 通用图标：home, settings, search, user, calendar, mail...
- 数据图标：trending-up, chart-bar, database, file-text...
- 业务图标：rocket, target, lightbulb, trophy, star...
- 箭头图标：arrow-right/left/up/down, chevron-right...
- 状态图标：check, check-circle, x-circle, alert-circle...
- 工具图标：edit, trash, download, upload, share...

### 外部图标库

如需更多图标，推荐从以下开源库获取：

1. **SVG Repo** (https://www.svgrepo.com/)

   - 本项目图标来源
   - 50万+ 免费 SVG 图标
   - 多种风格可选

2. **Lucide Icons** (https://lucide.dev/)

   - 简洁现代
   - SVG 格式
   - 高度一致性

3. **Material Icons** (https://fonts.google.com/icons)

   - 通用性强
   - 识别度高
   - 多种样式

3. **Feather Icons** (https://feathericons.com/)
   - 极简风格
   - 线条清晰
   - 轻量级

### 图标规范

```
尺寸:
  - 小图标: 16-20px
  - 常规图标: 24-32px
  - 大图标: 40-48px

线宽: 2px (统一)
颜色: 与主色调协调
间距: 图标大小的 50%
```

### 使用场景

```
✓ 章节标识
✓ 功能说明
✓ 列表项标记
✓ 状态指示
✓ 导航元素

✗ 避免过度装饰
✗ 避免混用风格
✗ 避免复杂图标
```

## 常见模式

### 封面页设计

```
布局:
  - 顶部: 公司Logo (可选)
  - 中部: 演示标题 (H1)
  - 副标题: 场景说明
  - 底部: 日期、演讲人

样式:
  - 简洁大气
  - 主色调背景或图片
  - 文字居中或偏左
```

### 内容页设计

```
标准结构:
  1. 页面标题 (顶部, H2)
  2. 主要内容 (中部)
  3. 页码/注释 (底部)

变体:
  - 左标题右内容
  - 上下分割
  - 多栏布局
```

### 数据页设计

```
重点:
  - 数据可视化为主
  - 关键数字突出显示
  - 提供数据来源
  - 添加趋势说明

布局:
  - 大图表 + 要点
  - 多个小图表组合
  - KPI仪表盘
```

### 总结页设计

```
内容:
  - 3-5个核心要点
  - 行动号召 (CTA)
  - 下一步计划

样式:
  - 列表或编号
  - 图标辅助
  - 简洁明了
```

## CRAP 原则应用

### Contrast (对比)

```
✓ 标题与正文差异明显
✓ 重要数据用不同颜色
✓ 背景与前景对比清晰
✓ 尺寸层级分明
```

### Repetition (重复)

```
✓ 统一的配色方案
✓ 一致的字体使用
✓ 相同的卡片样式
✓ 规律的间距系统
```

### Alignment (对齐)

```
✓ 所有元素明确对齐
✓ 使用网格系统
✓ 标题对齐统一
✓ 文本对齐一致
```

### Proximity (亲密性)

```
✓ 相关元素靠近
✓ 不同组块分离
✓ 逻辑分组明确
✓ 空白使用合理
```

## PPT 兼容性规范

为确保 SVG 导出到 PowerPoint 后视觉效果一致，必须遵守以下规则。

### 透明度写法规范

PowerPoint 对 SVG 透明度的支持有限，以下是兼容性对照表：

| 写法 | PPT 支持 | 说明 |
|------|---------|------|
| `fill="#FFF" fill-opacity="0.1"` | ✅ | 推荐：填充透明度 |
| `stroke="#FFF" stroke-opacity="0.1"` | ✅ | 推荐：描边透明度 |
| `opacity="0.1"` (在单个元素上) | ✅ | 支持：整体透明度 |
| `fill="rgba(255,255,255,0.1)"` | ❌ | 禁止：rgba 格式 |
| `<g opacity="0.1">` | ❌ | 禁止：组透明度 |
| `<image opacity="0.3"/>` | ❌ | 不支持：图片透明度 |

### 禁止：rgba() 颜色格式

```xml
<!-- ❌ 错误写法 -->
<rect fill="rgba(255,255,255,0.15)"/>

<!-- ✅ 正确写法 -->
<rect fill="#FFFFFF" fill-opacity="0.15"/>
```

### 禁止：组元素透明度

PPT 不支持 `<g>` 元素上的 `opacity` 属性，必须将透明度设置到每个子元素上：

```xml
<!-- ❌ 错误写法：组透明度 -->
<g opacity="0.1">
  <circle cx="100" cy="100" r="50" fill="none" stroke="#FFF" stroke-width="1"/>
  <circle cx="100" cy="100" r="30" fill="none" stroke="#FFF" stroke-width="1"/>
  <line x1="0" y1="100" x2="200" y2="100" stroke="#FFF" stroke-width="1"/>
</g>

<!-- ✅ 正确写法：每个元素单独设置 -->
<circle cx="100" cy="100" r="50" fill="none" stroke="#FFF" stroke-width="1" stroke-opacity="0.1"/>
<circle cx="100" cy="100" r="30" fill="none" stroke="#FFF" stroke-width="1" stroke-opacity="0.1"/>
<line x1="0" y1="100" x2="200" y2="100" stroke="#FFF" stroke-width="1" stroke-opacity="0.1"/>
```

### 图片透明度：遮罩层方案

PPT 不支持 `<image>` 元素的 `opacity` 属性。使用**遮罩层叠加**实现相同效果：

```xml
<!-- ❌ 错误写法：图片透明度会丢失 -->
<rect width="1280" height="720" fill="#2C3E50"/>
<image href="bg.png" width="1280" height="720" opacity="0.35"/>

<!-- ✅ 正确写法：遮罩层方案 -->
<rect width="1280" height="720" fill="#2C3E50"/>
<image href="bg.png" width="1280" height="720"/>
<rect width="1280" height="720" fill="#2C3E50" opacity="0.65"/>
```

**原理**：
- 原图片 `opacity="0.35"` → 遮罩层 `opacity="0.65"` (1 - 0.35)
- 遮罩层颜色使用背景渐变的起始色或主背景色

### 渐变定义中的透明度

渐变 `<stop>` 中使用 `stop-opacity` 是支持的：

```xml
<!-- ✅ 正确：渐变中使用 stop-opacity -->
<linearGradient id="fadeGradient">
  <stop offset="0%" style="stop-color:#D4AF37;stop-opacity:0"/>
  <stop offset="50%" style="stop-color:#D4AF37;stop-opacity:1"/>
  <stop offset="100%" style="stop-color:#D4AF37;stop-opacity:0"/>
</linearGradient>
```

### 检查清单

生成 SVG 后，确保以下内容：

- [ ] 搜索 `rgba(` - 应无结果
- [ ] 搜索 `<g opacity` 或 `<g.*opacity` - 应无结果
- [ ] 搜索 `<image.*opacity` - 应无结果，改用遮罩层
- [ ] 所有透明度使用 `fill-opacity`、`stroke-opacity` 或单元素 `opacity`

## 常见问题与解决方案

### Q: 内容太多放不下？

```
解决方案:
1. 分成多页展示
2. 使用更小字号（不低于16px）
3. 精简文字，突出要点
4. 使用图表代替文字
```

### Q: 颜色搭配不协调？

```
解决方案:
1. 使用配色工具（如Coolors.co）
2. 限制主色数量（不超过3种）
3. 增加中性色占比
4. 参考成功案例
```

### Q: 布局看起来不平衡？

```
解决方案:
1. 检查对齐关系
2. 调整元素间距
3. 使用网格系统
4. 平衡视觉重量
```

## 参考资源

- [Material Design Color System](https://material.io/design/color)
- [Adobe Color](https://color.adobe.com/)
- [Coolors](https://coolors.co/)
- [Type Scale](https://type-scale.com/)
- [Grid Calculator](https://www.gridcalculator.dk/)

---

本指南持续更新中。如有建议，欢迎提交 Issue 或 PR。
