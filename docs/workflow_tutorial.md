# 工作流教程

本教程将通过实际案例，手把手教你如何使用 PPT Master 系统创建专业的 SVG 演示文稿。

## 教程概览

- [准备工作](#准备工作)
- [案例 1: 创建季度业务报告](#案例1-创建季度业务报告)
- [案例 2: 市场分析演示](#案例2-市场分析演示)
- [高级技巧](#高级技巧)
- [常见问题](#常见问题)

## 准备工作

### 1. 理解四个角色

在开始之前，确保你理解每个角色的职责：

| 角色                    | 输入     | 输出           | 何时使用     | 支持格式 |
| ----------------------- | -------- | -------------- | ------------ | -------- |
| **Strategist**          | 源文档   | 设计规范与大纲 | 项目开始时   | 所有格式 |
| **Executor_General**    | 设计规范 | SVG 代码       | 通用风格项目 | 所有格式 |
| **Executor_Consultant** | 设计规范 | SVG 代码       | 咨询风格项目 | 所有格式 |
| **Optimizer_CRAP**      | SVG 代码 | 优化后的 SVG   | 需要优化时   | 所有格式 |

### 2. 准备你的内容

确保你的源文档包含：

- ✓ 清晰的标题和章节
- ✓ 具体的数据和数字
- ✓ 要点和关键信息
- ✓ 逻辑结构

### 3. 选择画布格式

根据使用场景选择合适的格式（详见 [画布格式规范](./canvas_formats.md)）：

**演示文稿场景：**
- PPT 16:9 (1280×720) - 现代投影设备
- PPT 4:3 (1024×768) - 传统投影设备

**社交媒体场景：**
- 小红书 (1242×1660) - 知识分享、产品种草
- 朋友圈 (1080×1080) - 活动海报、品牌宣传
- Story (1080×1920) - 短视频封面、快拍

**营销物料场景：**
- 公众号头图 (900×383) - 文章配图
- 横版海报 (1920×1080) - 网页Banner
- 竖版海报 (1080×1920) - 手机广告

### 4. 选择设计风格

思考你的内容特性：

**选择高端咨询风格，如果：**

- 面向高管或董事会
- 需要展示战略分析
- 数据密集型内容
- 追求极致专业感

**选择通用灵活风格，如果：**

- 一般商业演示
- 团队内部汇报
- 教育培训内容
- 需要更多创意自由

## 案例 1: 创建季度业务报告

### 场景设定

你需要为公司高层创建一份 Q3 季度业务回顾演示，包含业绩数据、项目进展和未来规划。

### 步骤 1: 与 Strategist 对话（初始沟通）

⚠️ **重要**: 在开始内容分析之前，Strategist 必须首先完成初始沟通与范围确认。

**Strategist 的首要问题：**

```
在开始分析您的内容之前，我需要先确认几个关键信息：

a. 画布格式确认：
   请问您计划在什么场景下使用这些内容？

   [Strategist 建议]: 根据您描述的季度战略会议场景，我建议使用
   **PPT 标准格式 (1280×720, 16:9)**，这是现代商业演示的主流格式，
   适合大多数投影设备和显示器。

b. 页数范围确认：
   根据您选择的格式和源文档，您期望生成多少页内容？
   （例如：5-7 页，10-15 页）这有助于我更好地把握内容的详略程度。

   [Strategist 建议]: 根据您提供的内容结构，我建议生成 8-10 页左右，
   这样可以确保每个核心议题都有充分的展示空间，同时保持演示的紧凑性。

c. 关键信息确认：
   除了文档本身，是否有任何我需要特别了解的背景信息？
   例如，这次内容的目标受众是谁？将在什么场合使用？
   您最希望受众记住的核心信息是什么？

   [Strategist 建议]: 根据文档中包含的业绩数据和战略分析，我初步判断
   这份演示可能面向企业中高层管理者，适用于季度/年度战略会议或董事会
   汇报场景。是否准确？核心信息建议聚焦于"Q3业绩稳健增长，Q4战略方向明确"。

d. 风格目标确认：
   请问本次设计我们采用 A) 通用灵活风格 还是 B) 高端咨询风格？

   [Strategist 建议]: 考虑到本次演示面向高管层且包含大量战略分析数据，
   我强烈建议选择 B) 高端咨询风格，以体现专业性和权威感。
```

**你的回应：**

```
a. 同意使用 PPT 标准格式 (1280×720, 16:9)
b. 期望 8-10 页左右
c. 目标受众是公司董事会和高管团队，将在季度战略会议上使用。
   核心信息是：Q3业绩稳健增长，Q4需要重点关注的战略方向。
d. 选择 B) 高端咨询风格
```

**你的源文档内容：**

```
我需要创建一份Q3季度业务报告的演示文稿。主要内容包括：

1. 核心业绩指标（营收、客户数、满意度、市场份额）
2. 重点项目进展（产品升级、市场拓展、运营优化）
3. 面临的挑战（竞争、人才、成本、合规）
4. Q4战略重点（产品创新、市场深耕、组织建设、风险管控）
5. 财务展望

目标受众是公司高管层。
```

### 步骤 2: 获取设计规范

完成初始沟通后，**Strategist 将输出：**

```markdown
# Q3 季度业务报告 - 设计规范与内容大纲（精简版）

## 一、项目概述

**源文档主题**: Q3 季度业务回顾与 Q4 战略展望
**设计风格**: 高端咨询风格（数据驱动、结构化）
**目标受众**: 董事会和高管团队
**核心目标**: 展示 Q3 业绩成果，明确 Q4 战略方向
**页面数量**: 9 页

## 二、整体设计规范（精简版）

### 1. 视觉主题提案

建议采用"高端咨询风格（亮色主题）"以突出数据的清晰度和专业性。请您确认。

### 2. 色彩方案提案

建议色彩方案：主导色为德勤蓝 (#0076A8)，搭配专业灰度色系。
请您确认，或提供您的品牌主色。

### 3. 核心布局原则

### 视觉主题

建议采用"高端咨询风格（亮色主题）"以突出数据的清晰度和专业性。

### 色彩方案

- 主导色: 德勤蓝 #0076A8
- 辅助色:
  - 成功绿 #4CAF50（正向指标）
  - 警示橙 #FF9800（需关注）
  - 提示红 #F44336（风险项）
- 中性色:
  - 深灰 #333333（主文本）
  - 中灰 #666666（副文本）
  - 浅灰 #E0E0E0（分隔线）

### 核心布局原则

- 画布: 1280×720px
- 边距: 40px
- 标题高度: 80px
- 内容区高度: 600px

## 二、页面序列规划

### 第 1 页: 封面

**主题**: Q3 业务回顾与 Q4 展望
**布局**: 居中式
**元素**:

- 公司 Logo（左上）
- 主标题 "2024 Q3 业务回顾"
- 副标题 "稳健增长 · 持续创新"
- 日期和演讲人

### 第 2 页: 核心业绩指标

**主题**: 超额达成季度目标
**布局**: 2×2 KPI 仪表盘
**数据**:

- 营收: 2.8 亿元 (+35% YoY)
- 客户数: 580 家 (+120 新增)
- NPS: 78 分 (+6 分)
- 市场份额: 18% (+3%)

### 第 3 页: 重点项目进展

**主题**: 三大核心项目全面推进
**布局**: 三栏卡片
**内容**:

- 产品升级: AI 功能上线
- 市场拓展: 华南市场突破
- 运营优化: 效率提升显著

### 第 4 页: 面临的挑战

**主题**: 风险识别与应对
**布局**: 2×2 矩阵
**内容**:

- 市场竞争（高影响-外部）
- 人才招聘（高影响-内部）
- 成本上升（中影响-内部）
- 合规要求（中影响-外部）

### 第 5 页: Q4 战略重点

**主题**: 四维发力实现突破
**布局**: 四象限
**内容**:

- 产品创新、市场深耕
- 组织建设、风险管控

### 第 6 页: 财务展望

**主题**: Q4 目标明确可达
**布局**: 左图右表
**内容**:

- 左侧: 营收趋势折线图
- 右侧: 财务指标表格

### 第 7 页: 结束页

**主题**: 感谢与下一步
**布局**: 居中式
**内容**:

- 感谢语
- 联系方式
- Q&A 提示
```

### 步骤 3: 确认并开始生成

**你的确认：**

```
规划看起来很好！请先生成第1页：封面页
```

### 步骤 4: Executor_Consultant 生成 SVG

**Executor_Consultant 将生成类似如下的 SVG 代码：**

```xml
<svg width="1280" height="720" viewBox="0 0 1280 720" xmlns="http://www.w3.org/2000/svg">
  <!-- 背景 -->
  <rect width="1280" height="720" fill="#FFFFFF"/>

  <!-- Logo区域 -->
  <text x="40" y="50" font-family="system-ui" font-size="18" fill="#0076A8" font-weight="600">
    YOUR COMPANY
  </text>

  <!-- 主标题 -->
  <text x="640" y="300" text-anchor="middle" font-family="system-ui" font-size="56" fill="#333333" font-weight="700">
    2024 Q3 业务回顾
  </text>

  <!-- 副标题 -->
  <text x="640" y="360" text-anchor="middle" font-family="system-ui" font-size="28" fill="#666666" font-weight="400">
    稳健增长 · 持续创新
  </text>

  <!-- 装饰线 -->
  <line x1="440" y1="380" x2="840" y2="380" stroke="#0076A8" stroke-width="3"/>

  <!-- 日期和演讲人 -->
  <text x="640" y="500" text-anchor="middle" font-family="system-ui" font-size="18" fill="#999999">
    2024年10月 | 业务部门汇报
  </text>

  <!-- 页码 -->
  <text x="1240" y="700" text-anchor="end" font-family="system-ui" font-size="14" fill="#CCCCCC">
    1
  </text>
</svg>
```

### 步骤 5: 逐页完成

继续请求生成其他页面：

```
你: 很好！请生成第2页：核心业绩指标
Executor: [生成KPI仪表盘SVG]

你: 请生成第3页：重点项目进展
Executor: [生成三栏卡片SVG]

... (继续其他页面)
```

### 步骤 6: 优化关键页面（可选）

对于重要的页面，可以请 Optimizer_CRAP 优化：

```
你: 请使用CRAP原则优化第2页的视觉效果

Optimizer_CRAP:
我将分析第2页的SVG并应用CRAP原则进行优化：

1. 对比(Contrast):
   - 增大数字与标签的尺寸对比
   - 使用更鲜明的颜色区分正负趋势

2. 重复(Repetition):
   - 统一四个KPI卡片的样式
   - 保持一致的圆角和阴影

3. 对齐(Alignment):
   - 确保卡片严格对齐网格
   - 文本元素垂直居中

4. 亲密性(Proximity):
   - 将相关数据更紧密地组合
   - 增大卡片间的间距

[输出优化后的SVG代码]
```

### 步骤 7: 导出和使用

完成所有页面后：

1. **保存 SVG 文件**

   - 使用统一的命名规则
   - 按页码顺序组织

2. **验证效果**

   - 在浏览器中逐页查看
   - 检查一致性和质量

3. **转换格式（可选）**
   - 转为 PNG 用于 PowerPoint
   - 转为 PDF 用于打印
   - 保留 SVG 用于后续编辑

## 案例 2: 小红书知识分享帖子

### 场景设定

为小红书平台创建一份知识分享帖子，介绍产品使用技巧，风格需要年轻化、易读性强。

### 快速流程

```
1. 准备内容
   - 产品核心功能介绍
   - 5个使用技巧
   - 常见问题解答
   - 推荐理由

2. 与Strategist对话
   你: 我需要为小红书创建一份产品使用技巧分享

   Strategist: 在开始之前，我需要确认几个关键信息：

   a. 画布格式确认：请问您计划在什么场景下使用这些内容？
      [建议]: 根据您描述的小红书知识分享场景，我建议使用
      **小红书帖子格式 (1242×1660, 3:4)**，这种竖屏比例最适合
      手机端浏览，且符合小红书用户的阅读习惯。

   b. 页数范围确认：您期望生成多少张图片内容？
      [建议]: 根据5个使用技巧的内容量，我建议生成 6-8 张，
      包括封面、逐个技巧展示、总结页，形成完整的图文轮播。

   c. 关键信息确认：目标受众和使用场合？
      [建议]: 从内容来看，这是面向小红书年轻用户的知识分享，
      建议采用轻松、易懂的表达方式，突出实用性。

   d. 风格目标确认：A) 通用灵活 还是 B) 高端咨询？
      [建议]: 考虑到小红书平台的特性和用户偏好，建议选择
      A) 通用灵活风格，可以更好地适应社交媒体的视觉需求。

   你: 同意你的建议，小红书格式 + 通用灵活风格

3. 确认设计规范
   Strategist: [输出规范，包含：
   - 画布格式: 1242×1660 (3:4)
   - 建议色彩方案（活泼年轻）
   - 竖屏单栏布局
   - 醒目标题设计
   - 适合手机阅读的字号]

4. 逐页生成
   你: 请生成第1张：封面
   Executor_General: [生成小红书格式SVG]
   ... (继续)

5. 完成交付
   导出所有SVG文件，可转为PNG后上传小红书
```

## 高级技巧

### 技巧 1: 自定义配色

```
你: 我们公司的品牌色是 #FF6B35（橙色），请使用这个作为主色调

Strategist: 收到！我将围绕 #FF6B35 构建配色方案：
- 主导色: #FF6B35
- 辅助色: #004E89（深蓝，形成对比）
- 点缀色: #FFD23F（黄色，协调暖色系）
- 中性色: 标准灰度
```

### 技巧 2: 调整布局密度

```
你: 第3页内容太多，看起来很挤

Strategist: 建议将第3页拆分为两页：
- 第3页: 前3个项目
- 第3.5页: 后2个项目

或者减少文本描述，只保留核心要点。您选择哪种方案？
```

### 技巧 3: 快速迭代

```
你: 第2页的字体太小了，请调大

Executor: 已将主要数字从48px调整为56px，
标签从18px调整为20px。请查看效果。
```

### 技巧 4: 统一风格

如果你已经有一些页面作为参考：

```
你: 请参考已有的前3页风格，生成第4页

Executor: 我会保持相同的：
- 配色方案
- 字体大小层级
- 卡片样式
- 间距规则
[生成SVG]
```

### 技巧 5: 添加数据可视化

```
你: 第5页需要展示过去6个月的营收趋势

Executor_Consultant: 建议使用折线图，包含：
- X轴: 6个月份
- Y轴: 营收金额
- 数据点标注
- 趋势线
[生成包含图表的SVG]
```

## 常见问题

### Q1: 生成的代码太长，无法完整显示？

**解决方案：**

```
你: 代码被截断了，请只生成SVG的主体部分，
我会自己添加开头和结尾的标签。

或者：请将代码分成几个部分发送
```

### Q2: 某个元素位置不对？

**解决方案：**

```
你: 标题与内容重叠了，请调整

Executor: 我将：
1. 标题Y坐标从60px调整为80px
2. 内容区起始Y坐标从100px调整为140px
[重新生成]
```

### Q3: 如何修改已生成的 SVG？

**解决方案：**

```
方法1: 重新生成
你: 请重新生成第2页，将主色改为绿色

方法2: 直接编辑
在文本编辑器中打开SVG文件
查找相应的颜色值（如#0076A8）
替换为新颜色（如#4CAF50）

方法3: 使用优化器
你: 请优化第2页，重点调整颜色使用
Optimizer_CRAP: [分析并优化]
```

### Q4: 文本如何换行？

**解决方案：**
SVG 中的文本换行使用 `<tspan>` 标签：

```xml
<text x="100" y="200">
  <tspan x="100" dy="0">第一行文本</tspan>
  <tspan x="100" dy="30">第二行文本</tspan>
  <tspan x="100" dy="30">第三行文本</tspan>
</text>
```

或者要求：

```
你: 这段文字太长，请分成3行显示

Executor: 我将使用tspan进行手动换行，
每行约20-25个字符。
```

### Q5: 如何添加图标？

**解决方案：**

```
你: 在第3页的每个卡片上添加相应的图标

Executor_Consultant: 我将使用Lucide图标：
- 产品升级: 使用 "rocket" 图标
- 市场拓展: 使用 "trending-up" 图标
- 运营优化: 使用 "settings" 图标
[生成包含图标的SVG]
```

## 效率提升建议

### 1. 准备充分

- ✓ 内容大纲清晰完整
- ✓ 数据准确可用
- ✓ 明确目标受众
- ✓ 确定时间节点

### 2. 批量操作

- ✓ 一次性与 Strategist 确认所有规范
- ✓ 连续生成多页避免上下文丢失
- ✓ 统一处理相似页面

### 3. 模板复用

- ✓ 保存成功的页面作为模板
- ✓ 记录常用的配色方案
- ✓ 建立个人风格指南

### 4. 质量控制

- ✓ 每完成 3-5 页就整体检查
- ✓ 确保风格统一
- ✓ 验证数据准确性

## 下一步

- 查看 [设计指南](./design_guidelines.md) 了解详细设计规范
- 查看 [示例文件](../examples/) 获取灵感
- 阅读 [角色定义](../roles/README.md) 深入理解每个角色

## 需要帮助？

- 📖 查阅文档
- 💬 提交 Issue
- 🌟 分享你的作品

---

祝你创作顺利！如有任何问题，欢迎反馈。
## 文本扁平化（去 tspan）

在生成阶段，按规范使用 `<tspan>` 进行手动换行。若发布链路或后续处理需要去除 `<tspan>`，可使用仓库自带工具进行后处理：

```bash
# 交互模式（等效）
python3 tools/flatten_tspan.py
python3 tools/flatten_tspan.py -i

# 扁平化整个 svg_output 目录（默认输出到同级 svg_output_flattext）
python3 tools/flatten_tspan.py examples/<project_name>_<format>_<YYYYMMDD>/svg_output

# 处理单个文件/自定义输出路径
python3 tools/flatten_tspan.py path/to/input.svg path/to/output.svg
```

默认输出：
- 目录输入：若路径以 `svg_output` 结尾，输出到同级 `svg_output_flattext`；否则为 `<目录>_flattext`
- 文件输入：输出为 `<文件名>_flattext.svg`

安全性：目录模式下工具会自动跳过输出子目录，避免递归处理。

检查要点：
- 输出中不应存在 `<tspan>`；
- 文本样式（`font-size`/`font-weight`/`fill`/`text-anchor` 等）与坐标/变换应与原图一致；
- 如发现偏差，优先在生成端修正 `<tspan>` 的 `x`/`dy` 与父 `<text>` 样式，再重跑扁平化。
